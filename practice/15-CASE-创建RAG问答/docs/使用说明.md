# RAG问答系统使用说明

## 系统概述

本系统是一个完整的检索增强生成（RAG）问答系统，专门用于AI产品经理面试题的智能问答。系统支持从PDF文档中提取文本、记录页码信息，并使用DeepSeek/ChatGPT进行智能回答。

## 功能特性

- ✅ PDF文档处理和页码记录
- ✅ 向量存储和相似度检索
- ✅ DeepSeek/ChatGPT API集成
- ✅ 交互式问答模式
- ✅ 自动测试模式
- ✅ 来源文档页码显示

## 系统架构

```
RAG问答系统/
├── code/
│   ├── pdf_processor.py       # PDF处理器
│   ├── deepseek_integration.py # API集成模块
│   └── rag_example.py         # 主RAG系统
├── data/
│   └── AI产品经理面试题65道.pdf # 知识库文档
├── test_system.py             # 系统测试脚本
└── 使用说明.md                # 本文档
```

## 安装依赖

```bash
# 进入项目目录
cd practice/15-CASE-创建RAG问答

# 安装依赖
uv sync
```

## 配置环境变量

系统会自动从以下位置加载.env文件（按优先级）：
1. 项目根目录：`/Users/lihaizhong/Documents/Project/build-your-own-x/build-your-own-ai/.env`
2. RAG项目目录：`practice/15-CASE-创建RAG问答/.env`
3. 当前目录：`.env`

支持的API密钥：
- `DASHSCOPE_API_KEY`: DashScope API密钥（必需）

系统完全使用DashScope提供服务，包括：
- LLM模型：使用通义千问（qwen-turbo）
- 嵌入模型：使用text-embedding-v2

## 使用方法

### 1. 运行系统测试

```bash
# 运行系统功能测试
uv run python test_system.py
```

### 2. 启动交互式问答系统

```bash
# 启动完整的RAG问答系统
uv run python code/rag_example.py
```

系统会显示选项菜单：
1. 交互式问答模式 - 手动输入问题进行问答
2. 自动测试模式 - 运行预设的测试问题
3. 退出

### 3. 交互式问答示例

```
请输入您的问题: 产品经理需要具备哪些核心能力？

正在检索与'产品经理需要具备哪些核心能力？'相关的文档...
正在生成回答...

============================================================
问题: 产品经理需要具备哪些核心能力？
============================================================
回答: [AI生成的回答内容]

来源文档:

1. 页码: 5, 来源: AI产品经理面试题65道.pdf
   内容: 产品经理需要具备的核心能力包括...

2. 页码: 12, 来源: AI产品经理面试题65道.pdf
   内容: 产品经理的专业技能要求...
```

## 系统工作流程

### Step1: 收集整理知识库
- 系统从PDF文件中提取文本内容
- 记录每个文本块对应的页码信息

### Step2: 从PDF中提取文本并记录页码
- 使用PyPDFLoader加载PDF文档
- 为每个文档块添加page_number元数据

### Step3: 处理文本并创建向量存储
- 使用RecursiveCharacterTextSplitter分割文档
- 使用DashScope嵌入模型生成向量
- 创建FAISS向量数据库

### Step4: 执行相似度搜索
- 根据用户问题检索最相关的文档块
- 返回前4个最相关的文档

### Step5: 使用问答链回答问题
- 使用DashScope通义千问模型生成回答
- 基于检索到的文档内容进行回答

### Step6: 显示来源页码
- 在回答中显示每个文档块的来源页码
- 提供详细的文档引用信息

## 技术栈

- **LangChain**: RAG框架
- **FAISS**: 向量数据库
- **DashScope**: 大语言模型和嵌入模型
  - 通义千问（qwen-turbo）：问答生成
  - text-embedding-v2：文本嵌入
- **PyPDF**: PDF处理

## 常见问题

### Q: 如何更换PDF文档？
A: 将新的PDF文件放入`data/`目录，并修改`rag_example.py`中的`PDF_FILE_PATH`变量。

### Q: 如何调整检索参数？
A: 在`create_complete_rag_system`函数中修改`retriever`的`search_kwargs`参数。

### Q: 如何更换DashScope模型？
A: 在`get_dashscope_llm`函数中修改`model_name`参数，可以选择不同的通义千问模型。

### Q: 系统支持哪些文档格式？
A: 目前主要支持PDF格式，可以通过修改PDF处理器来支持其他格式。

## 性能优化建议

1. **文档分割**: 根据文档内容调整`chunk_size`和`chunk_overlap`参数
2. **检索数量**: 调整检索返回的文档数量（默认为4）
3. **模型选择**: 根据需求选择不同的通义千问模型（qwen-turbo、qwen-plus、qwen-max等）
4. **缓存机制**: 可以添加向量数据库的持久化功能

## 扩展功能

系统支持以下扩展：
- 多文档支持
- 多轮对话
- 实时搜索
- 结果缓存
- Web界面

## 许可证

MIT License

## 联系方式

如有问题，请查看项目文档或联系开发团队。