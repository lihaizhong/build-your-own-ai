# MCP Agent 调用示例 - 项目概述

## 项目简介

MCP Agent 调用示例是一个基于 Qwen-Agent 框架，集成多种 MCP（Model Context Protocol）服务的智能助手项目。该项目展示了如何通过大语言模型（LLM）统一调用不同的 MCP 服务，实现自驾游规划、网页内容获取、新闻检索、文件管理等多样化功能，是学习 MCP 协议和 Agent 开发的完整实践案例。

## 核心功能

### 1. 自驾游规划
- 使用高德地图 MCP 服务规划自驾游路线
- 查找沿途景点、加油站、餐厅等 POI 信息
- 提供详细的行程建议和导航信息

**示例**: "规划从北京到上海的7天自驾游"

### 2. 网页内容获取
- 获取指定网页的内容
- 将网页内容转换为 Markdown 格式
- 提取网页中的关键信息

**示例**: "获取网页 https://example.com 的内容并转为Markdown格式"

### 3. 新闻检索
- 搜索最新的新闻资讯
- 根据关键词检索相关新闻
- 提供新闻摘要和链接

**示例**: "搜索最新的关税新闻"

### 4. 文件管理
- 统计桌面上的 txt 文件数量
- 列出所有 txt 文件
- 读取指定 txt 文件的内容

**示例**: "统计桌面上的txt文件数量"

## 应用场景

### 1. 智能旅行规划
- 自驾游路线规划
- 沿途服务设施查询
- 行程优化建议

### 2. 信息聚合与分析
- 多源信息获取
- 网页内容提取
- 新闻资讯检索

### 3. 本地文件管理
- 文件统计与检索
- 内容快速查看
- 批量文件操作

### 4. AI Agent 开发学习
- MCP 协议实践
- 多服务集成
- Agent 架构设计

## 技术特点

### 1. MCP 协议集成
- 支持多种 MCP 服务类型
- npm 包方式集成（高德地图）
- SSE 远程服务集成（Fetch、Bing搜索）
- 本地 Python MCP Server（TXT 统计）

### 2. 统一 Agent 入口
- 通过自然语言统一调用多种服务
- 智能意图识别和服务选择
- 自动参数提取和传递

### 3. 灵活配置管理
- 环境变量配置 API Key
- 可选启用/禁用特定 MCP 服务
- 支持动态服务配置

### 4. 双模式运行
- Web 图形界面模式
- 终端交互模式
- 测试模式

## 项目结构

```
20-CASE-调用Agent调用MCP/
├── code/                           # 核心代码目录
│   ├── __init__.py                # 模块初始化
│   ├── main.py                    # 主程序入口
│   └── mcp_servers/               # MCP Server 目录
│       ├── __init__.py            # MCP Server 模块初始化
│       └── txt_counter.py         # 自定义 TXT 统计 MCP Server
├── data/                           # 数据目录
├── output/                         # 输出目录
├── workspace/                      # 工作空间目录
│   └── tools/                     # 工具目录
├── docs/                           # 文档目录
│   ├── 00-文档索引.md
│   ├── 01-项目概述.md
│   ├── 02-技术架构.md
│   ├── 03-使用指南.md
│   ├── 04-代码实现.md
│   └── 05-测试和部署.md
└── README.md                       # 项目说明文档
```

## 技术栈

### 核心技术
- **Python 3.11+**: 主要编程语言
- **Qwen Agent**: 阿里云大模型 Agent 框架
- **DashScope**: 阿里云大模型 API 服务
- **FastMCP**: Python MCP Server 快速开发框架

### 大模型服务
- **通义千问 (Qwen)**: 大语言模型
- **qwen-max**: 推荐模型版本

### MCP 服务
- **@amap/amap-maps-mcp-server**: 高德地图 MCP（npm 包）
- **fetch**: 网页内容获取（SSE 远程）
- **bing-cn-mcp-server**: Bing 中文搜索（SSE 远程）
- **txt-counter**: 自定义 TXT 统计（本地 Python）

### 其他依赖
- **Node.js**: 运行 npm 包方式的 MCP 服务
- **loguru**: 日志记录
- **python-dotenv**: 环境变量管理

## 性能指标

### 响应性能
- **本地 MCP 调用**: 通常 1-3 秒
- **远程 MCP 调用**: 通常 3-10 秒
- **复杂任务**: 10-30 秒（如路线规划）

### 服务可用性
- **本地 MCP 服务**: 99.9% 可用
- **远程 MCP 服务**: 取决于网络和服务状态
- **大模型调用**: 取决于 API 服务状态

### 并发能力
- **单实例并发**: 支持 5+ 并发请求
- **MCP 服务**: 各服务独立运行
- **大模型 API**: 受 API 限流控制

## 项目价值

### 1. 学习价值
- 深入理解 MCP 协议原理
- 掌握 Agent 系统开发流程
- 学习多服务集成最佳实践
- 了解大模型应用开发模式

### 2. 实用价值
- 快速构建智能助手应用
- 实现多源信息聚合
- 降低 AI 应用开发门槛
- 提供可复用的技术方案

### 3. 技术价值
- 展示 MCP 协议实践
- 提供 Agent 架构参考
- 推动标准化工具集成
- 促进 AI 生态发展

## 与传统方案对比

| 特性 | 传统 API 集成 | MCP Agent 方案 |
|------|--------------|---------------|
| 集成方式 | 各服务独立对接 | 统一协议标准 |
| 学习成本 | 需要学习各 API | 仅需了解 MCP 协议 |
| 扩展性 | 需要修改代码 | 配置即可扩展 |
| 维护成本 | 高（多接口维护） | 低（协议统一） |
| 灵活性 | 固定功能组合 | 自然语言驱动 |
| 成本 | 多个 API 费用 | 大模型 + MCP 服务 |

## 发展规划

### 短期目标
- [x] 完成核心 MCP 服务集成
- [x] 实现多模式运行支持
- [x] 提供完整文档体系
- [ ] 添加更多 MCP 服务

### 中期目标
- [ ] 支持更多地图服务
- [ ] 添加文件操作 MCP
- [ ] 实现多轮对话上下文
- [ ] 支持自定义 MCP 配置界面

### 长期目标
- [ ] 构建完整的 MCP 服务生态
- [ ] 支持多模态数据交互
- [ ] 实现企业级部署方案
- [ ] 开源社区贡献

## 快速体验

### 最小化启动

```bash
# 1. 配置环境变量
export DASHSCOPE_API_KEY=your_api_key_here

# 2. 启动服务
cd practice/20-CASE-调用Agent调用MCP
python code/main.py
```

### 典型交互示例

```
用户: 统计桌面上的txt文件数量

助手: 我来帮你统计桌面上的 txt 文件数量...
在桌面上找到 5 个 .txt 文件：
- notes.txt
- todo.txt
- readme.txt
- config.txt
- temp.txt
```

```
用户: 规划从北京到上海的7天自驾游

助手: 我来帮你规划从北京到上海的7天自驾游路线...
[调用高德地图 MCP 服务]
正在为您规划最佳路线，包括沿途景点、加油站和餐厅推荐...
```

## 相关资源

### 官方文档
- [MCP 官方文档](https://modelcontextprotocol.io/)
- [Qwen-Agent 文档](https://github.com/QwenLM/Qwen-Agent)
- [FastMCP 文档](https://github.com/jlowin/fastmcp)

### MCP 服务
- [高德地图 MCP Server](https://www.npmjs.com/package/@amap/amap-maps-mcp-server)
- [MCP 服务市场](https://modelcontextprotocol.io/introduction)

### 学习资源
- [MCP 协议介绍](https://modelcontextprotocol.io/docs/concepts/architecture)
- [Agent 开发指南](https://github.com/QwenLM/Qwen-Agent/blob/master/README.md)

---

*最后更新: 2026年2月24日*
*项目版本: v1.0*
*技术支持: build-your-own-ai项目团队*
