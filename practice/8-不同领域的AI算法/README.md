# 八、不同领域的AI算法

## 模型设计步骤

1. Step 1：数据加载
2. Step 2：数据探索
3. Step 3：特征选择
4. Step 4：模型训练
5. Step 5：模型预测

### XGBoost 超参数设置

祖传超参数：

```python
model = xgb.XGBRegressor(
    n_estimators=2000,
    learning_rate=0.1,
    subsample=0.8,
    colsample_bytree=0.8,
    min_child_samples=3,
    eval_metric='auc',
    reg_lambda=0.5,
    max_depth=15,
    tree_method='gpu_hist'
)
```

### 如何进行特征工程

以“二手车价格预测”为例：

1. 数据预处理
    - 加载训练集和测试集数据，合并数据，便于统一进行特征工程。
2. 特征工程
    - 创建时间特征（如车龄、注册季节等）。
    - 创建车辆特征（如功率、品牌-车型组合、异常值处理等）。
    - 创建统计特征（如品牌均价、品牌价格比等）。
    - 编码分类特征（如频率编码、CatBoost 分类特征标记）。
3. 特征选择与数据准备
    - 删除无用特征：SaleID、name、offerType、seller（所有车 offerType=0，seller只有 1 个为 1，其他都为 0）
    - 确认所有分类特征被正确标记。
    - 转换分类特征为 category 类型。

### 时间特征对建模的重要性

以“二手车价格预测”为例：

- 反映业务本质

**时间特征时间特征往往与业务场景密切相关**。例如，在二手车价格预测中，车辆在使用年限（车龄）直接影响其残值，通常车龄越大，价格越低。

- 揭示数据变化趋势

**时间特征可以揭示模型捕捉数据随时间变化的趋势和周期性**。例如，某些车型在特定年份或季节更受欢迎，价格可能更高。

- 辅助异常检测

**时间特征有助于发现数据中的异常点**。比如，注册日期晚于创建日期、车龄为负等，这些异常会影响模型效果。

## 特征工程的价值

特征工程决策模型上限，而模型（调参）只是把上限跑出来而已。

- **丰富的数据表达**：通过多维度、多层次的特征衍生，极大提升了模型对业务本质的理解能力。
- **高效的类别特征利用**：充分发挥 CatBoost 对类别特征的原生支持，避免 one-hot 维度爆炸，提升模型性能。
- **异常与缺失处理**：通过缺失标记和异常值修正，提升模型鲁棒性和泛化能力。

### Cursor进行特征工程，存在概率性的情况

可能处理会有问题，比如：

- 将 power + model 进行数值相加，实际上没有物理含义，增加了噪音。
- 没有讲训练集和测试集合并，单独处理的特征工程，可能测试集的编码缺失的情况。
- 对 kilometers 的分箱可能是 [0, 5, 10, 20]，并不能反映整体的数据集的情况等。

需要从业务角度，对特征工程进行验证。
