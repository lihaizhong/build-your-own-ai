# 二手车价格预测特征工程总结

## 1. 时间特征

时间特征是二手车价格预测中的关键因素，我们对原始的日期数据进行了以下处理：

### 1.1 基础时间特征
- **车辆年龄**：计算车辆从注册到创建记录的天数和年数
- **注册日期分解**：将注册日期拆分为年、月、日三个独立特征
- **创建日期分解**：将创建日期拆分为年、月、日三个独立特征

### 1.2 高级时间特征
- **车龄分段**：将车龄划分为不同区间（0-1年、1-3年、3-5年、5-10年、10年以上）
- **季节特征**：从月份计算季度信息
- **是否为新车**：根据车龄判断是否为新车（使用年限<1年）
- **每年行驶公里数**：公里数除以使用年限

## 2. 车辆特征

### 2.1 缺失值处理
- 为每个数值型特征创建缺失标记（_missing）
- 使用中位数填充缺失值

### 2.2 特征交互
- **功率与排量比**：衡量车辆性能指标
- **品牌与车型组合**：捕捉更细粒度的车辆类别信息
- **功率与车型组合**：不同车型的功率水平

### 2.3 异常值处理
- 使用百分位数（5%-95%）识别并处理异常值
- 为每个主要数值特征创建异常值标记（_outlier）
- 对异常值进行截断处理

## 3. 统计特征

统计特征能够捕捉群体效应，有效提高预测准确性：

### 3.1 品牌级别统计
- 品牌平均价格
- 品牌价格中位数
- 品牌价格标准差
- 品牌车辆数量

### 3.2 车型级别统计
- 车型平均价格
- 车型价格中位数
- 车型价格标准差
- 车型数量

### 3.3 车龄分段统计
- 不同车龄段的平均价格
- 不同车龄段的价格中位数
- 不同车龄段的价格标准差

### 3.4 相对价格特征
- 品牌价格比率：品牌平均价格与总体平均价格的比值
- 车型价格比率：车型平均价格与总体平均价格的比值

## 4. 分类特征编码

合理的分类特征编码对预测性能有显著影响：

### 4.1 频率编码
- 对每个分类特征计算其在数据集中出现的频率
- 将高基数分类变量（如品牌、车型）转换为数值特征

### 4.2 CatBoost专用处理
- 将分类变量标记为CatBoost可识别的格式
- 处理分类特征中的缺失值

## 5. 特征选择与数据准备

### 5.1 特征选择
- 删除不再需要的列（原始日期、中间变量等）
- 确保所有分类特征都被正确标记

### 5.2 数据准备
- 类型转换：将分类特征转换为category类型
- 分离训练集和测试集
- 划分训练集和验证集

## 6. 关键实现细节

### 6.1 防止数据泄露
- 仅使用训练集数据创建统计特征
- 避免使用未来信息

### 6.2 特征命名规范
- 使用描述性名称便于理解和维护
- 对衍生特征采用统一的命名模式

### 6.3 错误处理
- 处理无效日期和时间格式
- 修复异常的车辆年龄计算

## 7. 模型训练与预测

### 7.1 CatBoost模型优势
- 原生支持分类特征
- 处理缺失值能力强
- 对过拟合有较好的抵抗力

### 7.2 特征重要性分析
- 识别最具预测力的特征
- 指导未来特征工程方向

## 8. 预测结果

特征工程结合CatBoost模型取得了良好效果：
- MAE: 521.15
- RMSE: 1284.19
- R²: 0.9699

## 9. 未来优化方向

- 尝试更复杂的特征交互
- 引入外部数据（如车辆评价、市场趋势）
- 构建更精细的地理位置特征
- 实现自动化特征选择流程 